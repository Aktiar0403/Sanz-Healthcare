<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Management - Sanj Healthcare</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/finance.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-chart-line"></i> Finance Management</h1>
            <div class="header-actions">
                <button id="refreshBtn" class="btn btn-secondary">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <button id="exportReportsBtn" class="btn btn-primary">
                    <i class="fas fa-file-export"></i> Export to Reports
                </button>
            </div>
        </header>

        <div class="finance-container">
            <!-- Summary Cards -->
            <div class="summary-cards">
                <div class="card income-card">
                    <div class="card-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <div class="card-content">
                        <h3>Total Income</h3>
                        <p id="totalIncome">₹0.00</p>
                    </div>
                </div>
                
                <div class="card expense-card">
                    <div class="card-icon">
                        <i class="fas fa-receipt"></i>
                    </div>
                    <div class="card-content">
                        <h3>Total Expenses</h3>
                        <p id="totalExpenses">₹0.00</p>
                    </div>
                </div>
                
                <div class="card profit-card">
                    <div class="card-icon">
                        <i class="fas fa-chart-bar"></i>
                    </div>
                    <div class="card-content">
                        <h3>Net Profit</h3>
                        <p id="netProfit">₹0.00</p>
                    </div>
                </div>
                
                <div class="card margin-card">
                    <div class="card-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="card-content">
                        <h3>Profit Margin</h3>
                        <p id="profitMargin">0.00%</p>
                    </div>
                </div>
            </div>

            <!-- Accordion Forms -->
            <div class="accordion-container">
                <!-- Add Income Accordion -->
                <div class="accordion">
                    <div class="accordion-header">
                        <h2><i class="fas fa-plus-circle"></i> Add Income</h2>
                        <span class="accordion-toggle"><i class="fas fa-chevron-down"></i></span>
                    </div>
                    <div class="accordion-content">
                        <form id="incomeForm" class="finance-form">
                            <div class="form-group">
                                <label for="incomeSource">Source</label>
                                <select id="incomeSource" required>
                                    <option value="">Select Source</option>
                                    <option value="Product Sale">Product Sale</option>
                                    <option value="Service Revenue">Service Revenue</option>
                                    <option value="Investment Return">Investment Return</option>
                                    <option value="Commission">Commission</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="incomeCategory">Category</label>
                                <select id="incomeCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="Sales">Sales</option>
                                    <option value="Services">Services</option>
                                    <option value="Investments">Investments</option>
                                    <option value="Commissions">Commissions</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="incomeAmount">Amount (₹)</label>
                                <input type="number" id="incomeAmount" step="0.01" min="0" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="incomeDate">Date</label>
                                <input type="date" id="incomeDate" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="incomeCustomer">Customer (Optional)</label>
                                <input type="text" id="incomeCustomer">
                            </div>
                            
                            <div class="form-group">
                                <label for="incomeNotes">Notes</label>
                                <textarea id="incomeNotes" rows="3"></textarea>
                            </div>
                            
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-plus"></i> Add Income
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- Add Expense Accordion -->
                <div class="accordion">
                    <div class="accordion-header">
                        <h2><i class="fas fa-minus-circle"></i> Add Expense</h2>
                        <span class="accordion-toggle"><i class="fas fa-chevron-down"></i></span>
                    </div>
                    <div class="accordion-content">
                        <form id="expenseForm" class="finance-form">
                            <div class="form-group">
                                <label for="expenseCategory">Category</label>
                                <select id="expenseCategory" required>
                                    <option value="">Select Category</option>
                                    <option value="Purchase">Purchase</option>
                                    <option value="Marketing">Marketing</option>
                                    <option value="Operations">Operations</option>
                                    <option value="Salaries">Salaries</option>
                                    <option value="ROI Payouts">ROI Payouts</option>
                                    <option value="Commissions">Commissions</option>
                                    <option value="Transport">Transport</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="expenseAmount">Amount (₹)</label>
                                <input type="number" id="expenseAmount" step="0.01" min="0" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="expenseDate">Date</label>
                                <input type="date" id="expenseDate" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="expenseRemarks">Remarks</label>
                                <textarea id="expenseRemarks" rows="3" required></textarea>
                            </div>
                            
                            <button type="submit" class="btn btn-danger">
                                <i class="fas fa-plus"></i> Add Expense
                            </button>
                        </form>
                    </div>
                </div>
                
                <!-- Finance Summary Accordion -->
                <div class="accordion">
                    <div class="accordion-header">
                        <h2><i class="fas fa-chart-pie"></i> Finance Summary</h2>
                        <span class="accordion-toggle"><i class="fas fa-chevron-down"></i></span>
                    </div>
                    <div class="accordion-content">
                        <div class="summary-details">
                            <div class="summary-item">
                                <span class="summary-label">Total Income:</span>
                                <span class="summary-value" id="summaryIncome">₹0.00</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Total Expenses:</span>
                                <span class="summary-value" id="summaryExpenses">₹0.00</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Net Profit:</span>
                                <span class="summary-value" id="summaryProfit">₹0.00</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Profit Margin:</span>
                                <span class="summary-value" id="summaryMargin">0.00%</span>
                            </div>
                        </div>
                        
                        <div class="summary-actions">
                            <button id="refreshSummaryBtn" class="btn btn-secondary">
                                <i class="fas fa-sync-alt"></i> Refresh Summary
                            </button>
                            <button id="exportSummaryBtn" class="btn btn-primary">
                                <i class="fas fa-file-export"></i> Export to Reports
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Transaction Table -->
            <div class="transactions-section">
                <h2><i class="fas fa-list"></i> Recent Transactions</h2>
                
                <div class="table-controls">
                    <div class="filter-controls">
                        <select id="typeFilter">
                            <option value="all">All Types</option>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                        
                        <input type="date" id="dateFromFilter" placeholder="From Date">
                        <input type="date" id="dateToFilter" placeholder="To Date">
                        
                        <button id="applyFiltersBtn" class="btn btn-secondary">
                            <i class="fas fa-filter"></i> Apply Filters
                        </button>
                        <button id="clearFiltersBtn" class="btn btn-outline">
                            <i class="fas fa-times"></i> Clear
                        </button>
                    </div>
                    
                    <div class="search-controls">
                        <input type="text" id="searchInput" placeholder="Search transactions...">
                        <button id="searchBtn" class="btn btn-secondary">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>
                
                <div class="table-container">
                    <table id="transactionsTable" class="data-table">
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Source/Category</th>
                                <th>Amount</th>
                                <th>Date</th>
                                <th>Linked Tab</th>
                                <th>Notes</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="transactionsBody">
                            <!-- Transactions will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div class="table-footer">
                    <div class="pagination-info" id="paginationInfo">
                        Showing 0 of 0 transactions
                    </div>
                    <div class="pagination-controls">
                        <button id="prevPageBtn" class="btn btn-outline" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <span id="pageInfo">Page 1 of 1</span>
                        <button id="nextPageBtn" class="btn btn-outline" disabled>
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Edit Transaction Modal -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Transaction</h3>
                <span class="close">&times;</span>
            </div>
            <div class="modal-body">
                <form id="editForm">
                    <input type="hidden" id="editId">
                    
                    <div class="form-group">
                        <label for="editType">Type</label>
                        <select id="editType" required>
                            <option value="income">Income</option>
                            <option value="expense">Expense</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="editSource">Source</label>
                        <input type="text" id="editSource" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editCategory">Category</label>
                        <input type="text" id="editCategory" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editAmount">Amount (₹)</label>
                        <input type="number" id="editAmount" step="0.01" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editDate">Date</label>
                        <input type="date" id="editDate" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editLinkedTab">Linked Tab</label>
                        <input type="text" id="editLinkedTab">
                    </div>
                    
                    <div class="form-group">
                        <label for="editNotes">Notes</label>
                        <textarea id="editNotes" rows="3"></textarea>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="button" id="cancelEditBtn" class="btn btn-outline">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
        <p>Loading finance data...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="../js/firebase-config.js"></script>
    <script src="../js/finance.js"></script>
</body>
</html>